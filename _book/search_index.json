[
["spatial-network.html", "Chapter 2 Spatial network", " Chapter 2 Spatial network library(FARM) ## Warning: replacing previous import &#39;apTreeshape::is.binary.phylo&#39; by ## &#39;ape::is.binary.phylo&#39; when loading &#39;FARM&#39; ## Warning: replacing previous import &#39;ape::plot.mst&#39; by &#39;spdep::plot.mst&#39; ## when loading &#39;FARM&#39; library(spdep) ## Loading required package: sp ## Warning: package &#39;sp&#39; was built under R version 3.4.1 ## Loading required package: Matrix library(geosphere) library(maps) coords &lt;- as.matrix(apply(language_centroids[, 3:4], 2, as.numeric)) #coords conds &lt;- ifelse(suitability2 == 0, 1, 2) conds[is.na(conds)] &lt;- sample(c(1, 2), sum(is.na(conds)), replace = TRUE) origins &lt;- language_centroids[, 5] nbs_number &lt;- 2 this_row &lt;- 1 for(i in 5:9){ number_of_neighbors &lt;- i nbs &lt;- knearneigh(coords, k = number_of_neighbors, longlat = TRUE) nbs_list &lt;- knn2nb(nbs, sym = TRUE) png(paste(&quot;network_scratch_&quot;, number_of_neighbors, &quot;.png&quot;), width=11, height=5.5, res=1000, units = &quot;in&quot;) par(mar=c(0,0,0,0)) plot(0,0, xlim=c(-180,180), ylim=c(-90,90), type=&quot;n&quot;) map(&quot;world&quot;, col=adjustcolor(&quot;lightgrey&quot;, alpha=0.4), interior = FALSE, fill=TRUE, border=NA) #map(&quot;state&quot;, col=&quot;lightgrey&quot;) for(this_row in 1:length(nbs_list)){ for(nbs_number in 1:length(nbs_list[[this_row]])){ #pointser &lt;- NULL pointser &lt;- gcIntermediate(c(coords[nbs_list[[this_row]][nbs_number],1], coords[nbs_list[[this_row]][nbs_number],2]), c(coords[this_row,1], coords[this_row,2]), n=100, breakAtDateLine = T) length(pointser) #lines(pointser, col=&quot;red&quot;, lwd=.5) if(length(pointser) == 200){lines(pointser, col=&quot;cornflowerblue&quot;, lwd=.2)} if(length(pointser) == 2){lines(pointser[[1]], col=&quot;cornflowerblue&quot;, lwd=.2) lines(pointser[[2]], col=&quot;cornflowerblue&quot;, lwd=.2)} mtext(paste0(&quot;Network with at least &quot;, number_of_neighbors, &quot; connections between each culture&quot;), 3, line=0) }} dev.off() } "]
]
